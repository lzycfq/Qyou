webpackJsonp([24],{PsIm:function(e,t){},SJVs:function(e,t,s){"use strict";t.a=function(e){return/^1[3|4|5|7|8][0-9]\d{8}$/.test(e)}},kAwJ:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("Rus5"),o=s("SJVs"),a={name:"login",data:function(){var e=this,t=function(e,t,s){t?Object(o.a)(t)?s():s(new Error("请输入正确的11位手机号码")):s(new Error("请输入电话号码"))},s=function(t,s,r){""===s?r(new Error("请输入验证码")):s!==e.identifyCode?(console.log("validateVerifycode:",s),r(new Error("验证码不正确!"))):r()},r=function(e,t,s){if(!t)return s(new Error("请输入6位短信验证码"))};return{activeName:"second",ruleForm:{qzhangname:"",pass:"",phone:"",verifycode:"",phonecode:""},ruleForms:{phone:"",verifycode:"",phonecode:""},rules:{qzhangname:[{required:!0,message:"请输入账户/邮箱",trigger:"blur"},{min:3,max:15,message:"请输入正确账户",trigger:"blur"}],pass:[{validator:function(t,s,r){""===s?r(new Error("请输入密码")):(""!==e.ruleForm.checkPass&&e.$refs.ruleForm.validateField("checkPass"),r())},trigger:"blur",required:!0}],phone:[{required:!0,trigger:"blur",validator:t}],verifycode:[{required:!0,trigger:"blur",validator:s}],phonecode:[{required:!0,trigger:"blur",validator:r}]},duanxinrules:{phone:[{required:!0,trigger:"blur",validator:t}],verifycode:[{required:!0,trigger:"blur",validator:s}],phonecode:[{required:!0,trigger:"blur",validator:r}]},country:[{value:"中国",label:"012"},{value:"日本",label:"052"},{value:"泰国",label:"045"},{value:"新加坡",label:"032"},{value:"马来西亚",label:"045"}],countryvalue:"666",identifyCodes:"1234567890",identifyCode:"",show:!0,count:"",timer:null}},components:{SIdentify:r.a},props:[],mounted:function(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.axios.get("/api/buildlogin",{params:{qzhangname:t.ruleForm.qzhangname,pass:t.ruleForm.pass}}).then(function(e){console.log(e),t.$store.commit("ADD_COUNT",e.data.token),t.$store.commit("handleUserName",e.data.username),t.$store.commit("handleUserpic",e.data.userpic);var s=window.setInterval(function(){t.totalTime--,t.totalTime<0&&(window.clearInterval(s),t.$router.push("/"))},1e3)})})},submitsForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.axios.get("/api/buildlogin",{params:{countryphone:t.countryvalue,phone:t.ruleForm.phone,"verifycode ":t.ruleForm.verifycode,"phonecode ":t.ruleForm.phonecode}}).then(function(e){console.log(e),t.$store.commit("ADD_COUNT",e.data.token),t.$store.commit("handleUserName",e.data.username),t.$store.commit("handleUserpic",e.data.userpic);var s=window.setInterval(function(){t.totalTime--,t.totalTime<0&&(window.clearInterval(s),t.$router.push("/"))},1e3)})})},randomNum:function(e,t){return Math.floor(Math.random()*(t-e)+e)},refreshCode:function(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},makeCode:function(e,t){for(var s=0;s<t;s++)this.identifyCode+=this.identifyCodes[this.randomNum(0,this.identifyCodes.length)];console.log(this.identifyCode)}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-col",{attrs:{span:24}},[s("div",{staticClass:"login-container"},[s("div",{staticClass:"login-wrapper"},[s("div",{staticClass:"login-logo"},[s("img",{attrs:{src:"//fes.qyerstatic.com/fe_ssr_passport/static/login_logo2.41bd0a52.png",alt:"穷游"}}),e._v(" "),s("span",{staticClass:"titlelogin"},[e._v("登录")])]),e._v(" "),s("div",{staticClass:"login-section"},[s("div",{staticClass:"q-login-layout"},[s("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"账号登录",name:"first"}},[s("div",{staticClass:"q-login-tip"},[e._v("关于穷游网将实行"),s("router-link",{attrs:{to:""}},[e._v("手机绑定实名制的说明")])],1),e._v(" "),s("div",{staticClass:"q-login-form"},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[s("el-form-item",{attrs:{prop:"qzhangname"}},[s("el-input",{attrs:{placeholder:"请输入手机/账号",autocomplete:"off",rel:"qzhangname"},model:{value:e.ruleForm.qzhangname,callback:function(t){e.$set(e.ruleForm,"qzhangname",t)},expression:"ruleForm.qzhangname"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"pass"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码",autocomplete:"off",rel:"pass"},model:{value:e.ruleForm.pass,callback:function(t){e.$set(e.ruleForm,"pass",t)},expression:"ruleForm.pass"}})],1),e._v(" "),s("div",{staticClass:"input-tip"},[s("router-link",{staticClass:"remember-link fr",attrs:{to:""}},[e._v("忘记密码")])],1),e._v(" "),s("el-button",{staticClass:"haobtn",on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")])],1),e._v(" "),s("div",{staticClass:"q-login-auth"},[s("router-link",{staticClass:"auth-qq",attrs:{to:""}}),e._v(" "),s("router-link",{staticClass:"auth-weibo",attrs:{to:""}}),e._v(" "),s("router-link",{staticClass:"auth-taobao",attrs:{to:""}}),e._v(" "),s("router-link",{staticClass:"auth-weixin",attrs:{to:""}})],1),e._v(" "),s("div",{staticClass:"q-login-bottom"},[s("span",{staticClass:"fl"},[s("span",[e._v("没有穷游帐号？")]),e._v(" "),s("router-link",{attrs:{to:"register"}},[e._v("立即注册")])],1),e._v(" "),s("span",{staticClass:"fr"},[s("router-link",{staticClass:"gray",attrs:{to:""}},[e._v("境外手机号登录")])],1)])],1)]),e._v(" "),s("el-tab-pane",{attrs:{label:"短信快捷登录",name:"second"}},[s("div",{staticClass:"q-login-layout"},[s("div",{staticClass:"q-login-tip"},[e._v("关于穷游网将实行"),s("router-link",{attrs:{to:""}},[e._v("手机绑定实名制的说明")])],1),e._v(" "),s("div",{staticClass:"q-login-form q-login-formphone"},[s("el-form",{ref:"ruleForms",staticClass:"demo-ruleForm",attrs:{model:e.ruleForms,rules:e.duanxinrules}},[s("div",[s("div",{staticClass:"login-select"},[s("el-select",{attrs:{placeholder:"请选择",rel:"countryvalue"},model:{value:e.countryvalue,callback:function(t){e.countryvalue=t},expression:"countryvalue"}},e._l(e.country,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[s("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),s("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v("("+e._s(t.value)+")")])])}),1)],1),e._v(" "),s("el-form-item",{attrs:{prop:"phone"}},[s("div",{staticClass:"login-phone"},[s("el-input",{attrs:{placeholder:"请输入手机号码",autocomplete:"off",rel:"phone"},model:{value:e.ruleForms.phone,callback:function(t){e.$set(e.ruleForms,"phone",e._n(t))},expression:"ruleForms.phone"}})],1)])],1),e._v(" "),s("div",{staticClass:"verifycode"},[s("div",{staticClass:"yanzhengma"},[s("el-form-item",{attrs:{prop:"verifycode"}},[s("el-input",{staticClass:"identifyinput",attrs:{placeholder:"请输入验证码",rel:"verifycode"},model:{value:e.ruleForms.verifycode,callback:function(t){e.$set(e.ruleForms,"verifycode",t)},expression:"ruleForms.verifycode"}})],1)],1),e._v(" "),s("div",{staticClass:"identify"},[s("div",{on:{click:e.refreshCode}},[s("SIdentify",{attrs:{identifyCode:e.identifyCode}})],1)]),e._v(" "),s("div",{staticStyle:{clear:"both"}}),e._v(" "),s("p",{staticClass:"loginrefresh",on:{click:e.refreshCode}},[e._v("看不清，换一张 "),s("i",{staticClass:"el-icon-refresh"})])]),e._v(" "),s("div",{staticClass:"verifycode"},[s("div",{staticClass:"yanzhengma"},[s("el-form-item",{attrs:{prop:"phonecode"}},[s("el-input",{staticClass:"identifyinput",attrs:{placeholder:"请输入短信验证码",rel:"phonecode"},model:{value:e.ruleForms.phonecode,callback:function(t){e.$set(e.ruleForms,"phonecode",t)},expression:"ruleForms.phonecode"}})],1)],1),e._v(" "),s("div",{staticClass:"identify"},[s("el-button",{staticStyle:{width:"100%",position:"relative",top:"-16px"},attrs:{type:"success",disabled:e.disabled=!e.show},on:{click:e.send}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}]},[e._v("获取验证码")]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],staticClass:"count"},[e._v(e._s(e.count)+" s")])])],1)]),e._v(" "),s("div",{staticStyle:{clear:"both"}}),e._v(" "),s("el-button",{staticClass:"haobtn",on:{click:function(t){return e.submitsForm("ruleForms")}}},[e._v("登录")])],1)],1),e._v(" "),s("div",{staticClass:"q-login-auth"},[s("router-link",{staticClass:"auth-qq",attrs:{to:""}}),e._v(" "),s("router-link",{staticClass:"auth-weibo",attrs:{to:""}}),e._v(" "),s("router-link",{staticClass:"auth-taobao",attrs:{to:""}}),e._v(" "),s("router-link",{staticClass:"auth-weixin",attrs:{to:""}})],1),e._v(" "),s("div",{staticClass:"q-login-bottom"},[s("span",{staticClass:"fl"},[s("span",[e._v("没有穷游帐号？")]),e._v(" "),s("router-link",{attrs:{to:"register"}},[e._v("立即注册")])],1)])])])],1)],1)])])])])},staticRenderFns:[]};var l=s("C7Lr")(a,i,!1,function(e){s("PsIm")},null,null);t.default=l.exports}});