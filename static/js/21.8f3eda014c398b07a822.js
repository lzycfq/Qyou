webpackJsonp([21],{SJVs:function(e,t,r){"use strict";t.a=function(e){return/^1[3|4|5|7|8][0-9]\d{8}$/.test(e)}},ZcWA:function(e,t){},kAwJ:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("Rus5"),s=r("SJVs"),a={name:"login",data:function(){var e=this,t=function(e,t,r){t?Object(s.a)(t)?r():r(new Error("请输入正确的11位手机号码")):r(new Error("请输入电话号码"))},r=function(t,r,o){""===r?o(new Error("请输入验证码")):r!==e.identifyCode?(console.log("validateVerifycode:",r),o(new Error("验证码不正确!"))):o()},o=function(e,t,r){if(!t)return r(new Error("请输入6位短信验证码"))};return{activeName:"second",ruleForm:{qzhangname:"",pass:"",phone:"",verifycode:"",phonecode:""},ruleForms:{phone:"",verifycode:"",phonecode:""},rules:{qzhangname:[{required:!0,message:"请输入账户/邮箱",trigger:"blur"},{min:3,max:15,message:"请输入正确账户",trigger:"blur"}],pass:[{validator:function(t,r,o){""===r?o(new Error("请输入密码")):(""!==e.ruleForm.checkPass&&e.$refs.ruleForm.validateField("checkPass"),o())},trigger:"blur",required:!0}],phone:[{required:!0,trigger:"blur",validator:t}],verifycode:[{required:!0,trigger:"blur",validator:r}],phonecode:[{required:!0,trigger:"blur",validator:o}]},duanxinrules:{phone:[{required:!0,trigger:"blur",validator:t}],verifycode:[{required:!0,trigger:"blur",validator:r}],phonecode:[{required:!0,trigger:"blur",validator:o}]},country:[{value:"中国",label:"012"},{value:"日本",label:"052"},{value:"泰国",label:"045"},{value:"新加坡",label:"032"},{value:"马来西亚",label:"045"}],countryvalue:"666",identifyCodes:"1234567890",identifyCode:"",show:!0,count:"",timer:null}},components:{SIdentify:o.a},props:[],mounted:function(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.axios.get("/api/buildlogin",{params:{qzhangname:t.ruleForm.qzhangname,pass:t.ruleForm.pass}}).then(function(e){console.log(e),t.$store.commit("ADD_COUNT",e.data.token),t.$store.commit("handleUserName",e.data.username),t.$store.commit("handleUserpic",e.data.userpic);var r=window.setInterval(function(){t.totalTime--,t.totalTime<0&&(window.clearInterval(r),t.$router.push("/"))},1e3)})})},submitsForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.axios.get("/api/buildlogin",{params:{countryphone:t.countryvalue,phone:t.ruleForm.phone,"verifycode ":t.ruleForm.verifycode,"phonecode ":t.ruleForm.phonecode}}).then(function(e){console.log(e),t.$store.commit("ADD_COUNT",e.data.token),t.$store.commit("handleUserName",e.data.username),t.$store.commit("handleUserpic",e.data.userpic);var r=window.setInterval(function(){t.totalTime--,t.totalTime<0&&(window.clearInterval(r),t.$router.push("/"))},1e3)})})},randomNum:function(e,t){return Math.floor(Math.random()*(t-e)+e)},refreshCode:function(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},makeCode:function(e,t){for(var r=0;r<t;r++)this.identifyCode+=this.identifyCodes[this.randomNum(0,this.identifyCodes.length)];console.log(this.identifyCode)}}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-col",{attrs:{span:24}},[r("div",{staticClass:"login-container"},[r("div",{staticClass:"login-wrapper"},[r("div",{staticClass:"login-logo"},[r("img",{attrs:{src:"//fes.qyerstatic.com/fe_ssr_passport/static/login_logo2.41bd0a52.png",alt:"穷游"}}),e._v(" "),r("span",{staticClass:"titlelogin"},[e._v("登录")])]),e._v(" "),r("div",{staticClass:"login-section"},[r("div",{staticClass:"q-login-layout"},[r("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"账号登录",name:"first"}},[r("div",{staticClass:"q-login-tip"},[e._v("关于穷游网将实行"),r("router-link",{attrs:{to:""}},[e._v("手机绑定实名制的说明")])],1),e._v(" "),r("div",{staticClass:"q-login-form"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[r("el-form-item",{attrs:{prop:"qzhangname"}},[r("el-input",{attrs:{placeholder:"请输入手机/账号",autocomplete:"off",rel:"qzhangname"},model:{value:e.ruleForm.qzhangname,callback:function(t){e.$set(e.ruleForm,"qzhangname",t)},expression:"ruleForm.qzhangname"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"pass"}},[r("el-input",{attrs:{type:"password",placeholder:"请输入密码",autocomplete:"off",rel:"pass"},model:{value:e.ruleForm.pass,callback:function(t){e.$set(e.ruleForm,"pass",t)},expression:"ruleForm.pass"}})],1),e._v(" "),r("div",{staticClass:"input-tip"},[r("router-link",{staticClass:"remember-link fr",attrs:{to:""}},[e._v("忘记密码")])],1),e._v(" "),r("el-button",{staticClass:"haobtn",on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")])],1),e._v(" "),r("div",{staticClass:"q-login-auth"},[r("router-link",{staticClass:"auth-qq",attrs:{to:""}}),e._v(" "),r("router-link",{staticClass:"auth-weibo",attrs:{to:""}}),e._v(" "),r("router-link",{staticClass:"auth-taobao",attrs:{to:""}}),e._v(" "),r("router-link",{staticClass:"auth-weixin",attrs:{to:""}})],1),e._v(" "),r("div",{staticClass:"q-login-bottom"},[r("span",{staticClass:"fl"},[r("span",[e._v("没有穷游帐号？")]),e._v(" "),r("router-link",{attrs:{to:"register"}},[e._v("立即注册")])],1),e._v(" "),r("span",{staticClass:"fr"},[r("router-link",{staticClass:"gray",attrs:{to:""}},[e._v("境外手机号登录")])],1)])],1)]),e._v(" "),r("el-tab-pane",{attrs:{label:"短信快捷登录",name:"second"}},[r("div",{staticClass:"q-login-layout"},[r("div",{staticClass:"q-login-tip"},[e._v("关于穷游网将实行"),r("router-link",{attrs:{to:""}},[e._v("手机绑定实名制的说明")])],1),e._v(" "),r("div",{staticClass:"q-login-form q-login-formphone"},[r("el-form",{ref:"ruleForms",staticClass:"demo-ruleForm",attrs:{model:e.ruleForms,rules:e.duanxinrules}},[r("div",[r("div",{staticClass:"login-select"},[r("el-select",{attrs:{placeholder:"请选择",rel:"countryvalue"},model:{value:e.countryvalue,callback:function(t){e.countryvalue=t},expression:"countryvalue"}},e._l(e.country,function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v("("+e._s(t.value)+")")])])}),1)],1),e._v(" "),r("el-form-item",{attrs:{prop:"phone"}},[r("div",{staticClass:"login-phone"},[r("el-input",{attrs:{placeholder:"请输入手机号码",autocomplete:"off",rel:"phone"},model:{value:e.ruleForms.phone,callback:function(t){e.$set(e.ruleForms,"phone",e._n(t))},expression:"ruleForms.phone"}})],1)])],1),e._v(" "),r("div",{staticClass:"verifycode"},[r("div",{staticClass:"yanzhengma"},[r("el-form-item",{attrs:{prop:"verifycode"}},[r("el-input",{staticClass:"identifyinput",attrs:{placeholder:"请输入验证码",rel:"verifycode"},model:{value:e.ruleForms.verifycode,callback:function(t){e.$set(e.ruleForms,"verifycode",t)},expression:"ruleForms.verifycode"}})],1)],1),e._v(" "),r("div",{staticClass:"identify"},[r("div",{on:{click:e.refreshCode}},[r("SIdentify",{attrs:{identifyCode:e.identifyCode}})],1)]),e._v(" "),r("div",{staticStyle:{clear:"both"}}),e._v(" "),r("p",{staticClass:"loginrefresh",on:{click:e.refreshCode}},[e._v("看不清，换一张 "),r("i",{staticClass:"el-icon-refresh"})])]),e._v(" "),r("div",{staticClass:"verifycode"},[r("div",{staticClass:"yanzhengma"},[r("el-form-item",{attrs:{prop:"phonecode"}},[r("el-input",{staticClass:"identifyinput",attrs:{placeholder:"请输入短信验证码",rel:"phonecode"},model:{value:e.ruleForms.phonecode,callback:function(t){e.$set(e.ruleForms,"phonecode",t)},expression:"ruleForms.phonecode"}})],1)],1),e._v(" "),r("div",{staticClass:"identify"},[r("el-button",{staticStyle:{width:"100%",position:"relative",top:"-16px"},attrs:{type:"success",disabled:e.disabled=!e.show},on:{click:e.send}},[r("span",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}]},[e._v("获取验证码")]),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],staticClass:"count"},[e._v(e._s(e.count)+" s")])])],1)]),e._v(" "),r("div",{staticStyle:{clear:"both"}}),e._v(" "),r("el-button",{staticClass:"haobtn",on:{click:function(t){return e.submitsForm("ruleForms")}}},[e._v("登录")])],1)],1),e._v(" "),r("div",{staticClass:"q-login-auth"},[r("router-link",{staticClass:"auth-qq",attrs:{to:""}}),e._v(" "),r("router-link",{staticClass:"auth-weibo",attrs:{to:""}}),e._v(" "),r("router-link",{staticClass:"auth-taobao",attrs:{to:""}}),e._v(" "),r("router-link",{staticClass:"auth-weixin",attrs:{to:""}})],1),e._v(" "),r("div",{staticClass:"q-login-bottom"},[r("span",{staticClass:"fl"},[r("span",[e._v("没有穷游帐号？")]),e._v(" "),r("router-link",{attrs:{to:"register"}},[e._v("立即注册")])],1)])])])],1)],1)])])])])},staticRenderFns:[]};var l=r("C7Lr")(a,i,!1,function(e){r("ZcWA")},null,null);t.default=l.exports}});